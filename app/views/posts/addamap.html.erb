  <%= form_with(model: @post, local: true, html: {id: "form-post", :multipart => true}) do |form| %>

<%=form.label :addamap %>
<%=form.hidden_field :hei,id:'hei'%>
<%=form.hidden_field :wid,id: 'wid'%>
<%=form.file_field :addamap,onchange: "sizeimage(event);return false;" %>
<%=form.submit%>
<%end%>

<%=content_for :myjscode do%>
<script>
function sizeimage(e){
var file = e.target.files[0];
if (/\.(jpe?g|png|gif)$/i.test(file.name)) {
    var reader = new FileReader();
    reader.addEventListener("load", function () {
        var image = new Image();
        image.src = this.result;
        image.addEventListener('load', function () {
            console.log(`height: ${this.height}, width: ${this.width}`);
            $(hei).val(this.height);
            $(wid).val(this.width);
        });
                
    }, false);
            
    reader.readAsDataURL(file);
}
}
</script>
<%end%>

